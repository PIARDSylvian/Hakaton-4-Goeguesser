{% extends "GeoGuesserBundle::layout.html.twig" %}
{% block body %}

{% for flashMessage in app.session.flashbag.get('success') %}
    <div class="alert alert-success alert-dismissible col-md-10 col-md-offset-1" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <strong>Succes </strong>{{ flashMessage }}
        </div>
{% endfor %}

<div class="col-md-10 col-md-offset-1" id="propose"></div>
<form action="{{ path('add_place') }}" method="post">
    <input id="lng" type="hidden" name="lng" autocomplete="off">
    <input id="lat" type="hidden" name="lat" autocomplete="off">
    <input class="map_name" type="text" name="name" autocomplete="off">
    <button class="btn btn-default" id="send_propose">ajout ?</button>        
</form>
<script>
function initMap() {
    var map = new google.maps.Map(document.getElementById('propose'), {
        center: {lat: 1.000, lng: 1.000},
        zoom: 2,
        streetViewControl: false
    });

    var marker;
    var lng;
    var lat;    

    google.maps.event.addListener(map, 'click', function (event) {
        if (marker==null){
            marker = new google.maps.Marker({
                        map: map,
                        position: new google.maps.LatLng(event.latLng.lat(), event.latLng.lng())
                    });
        }
        else{
               marker.setMap(null);
               marker = new google.maps.Marker({
                        map: map,
                        position: new google.maps.LatLng(event.latLng.lat(), event.latLng.lng()),
                        
                    });                   
        }
        lng = event.latLng.lng();
        lat = event.latLng.lat();
    });
    $("#send_propose").click(function(){
        $("#lng").val(lng);
        $("#lat").val(lat);
    });

}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPa-lInPBnwmvKmSIcO2949-KWzmULmD4&callback=initMap"
async defer></script>

{% endblock body %}

